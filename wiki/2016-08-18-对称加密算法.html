<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<link rel="alternate"
      type="application/rss+xml"
      href="https://bruceasu.github.io/rss.xml"
      title="RSS feed for https://bruceasu.github.io/"/>
<title>对称加密算法</title>
<meta name="author" content="Bruce">
<meta name="referrer" content="no-referrer">
<link href= "/styles/org-manual.css" rel="stylesheet" type="text/css" />
<link rel="icon" href="static/favicon.ico">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="/styles/font.css">
<link rel="stylesheet" media="screen and (min-width: 600px)" href="/styles/post.css">
<link rel="stylesheet" media="screen and (max-width: 600px)" href="/styles/post_mobile.css">
<link rel="stylesheet" media="screen and (min-width: 600px)" href="/styles/navigatebar.css">
<link rel="stylesheet" media="screen and (max-width: 600px)" href="/styles/navigatebar_mobile.css">
<link rel="stylesheet" href="/theme/highlight.css">

</head>
<body>
<div class="navigatebar">
    <div class="navigatebar-button navigatebar-mine">
        <a href="/index.html">Free World</a>
    </div>
    <div class="navigatebar-slogan">
        「生活可以更简单, 欢迎来到我的开源世界」
    </div>
    <div class="navigatebar-button">
        <a href="/index.html">Home</a>
    </div>
    <div class="navigatebar-button">
        <a href="/tags.html">Tags</a>
    </div>
    <div class="navigatebar-button">
        <a href="/rss.xml">Feeds</a>
    </div>
    <div class="navigatebar-button navigatebar-about">
        <a href="/about.html">About</a>
    </div>
</div>

      <div class="content-area">
<div class="title">对称加密算法</div>
<div class="category-area"><a href="https://bruceasu.github.io/tags.html#reprint"><div class="category">reprint</div></a> </div>
<div class="char-counter">2016-08-18</div>
        <div id="content">
<nav id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org061f888">对称加密算法</a>
<ul>
<li><a href="#org908f682">定义</a></li>
<li><a href="#org3881dfc">优缺点</a></li>
<li><a href="#org0b37acd">常用对称加密算法</a></li>
</ul>
</li>
<li><a href="#org577ba6a">DES</a>
<ul>
<li><a href="#org8bfb555"> 概述</a></li>
<li><a href="#orgb0066f0"> 算法原理</a></li>
<li><a href="#org6016606"> 五种分组模式</a>
<ul>
<li><a href="#orgf2cb3dc">EBC模式</a></li>
<li><a href="#org2666b0e">CBC模式</a></li>
<li><a href="#org1e2f1e7">CFB模式</a></li>
<li><a href="#org3ee964f">OFB模式</a></li>
<li><a href="#orgdd9ac56">CTR模式</a></li>
</ul>
</li>
<li><a href="#org83801f8">常用的填充方式</a>
<ul>
<li><a href="#org3ec534f">ZerosPadding</a></li>
<li><a href="#org0a84d18">PKCS5Padding</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</nav>

<div id="outline-container-org061f888" class="outline-2">
<h2 id="org061f888">对称加密算法</h2>
<div class="outline-text-2" id="text-org061f888">
</div>
<div id="outline-container-org908f682" class="outline-3">
<h3 id="org908f682">定义</h3>
<div class="outline-text-3" id="text-org908f682">
<p>
对称加密算法是应用较早的加密算法，技术成熟。在对称加密算法中，数据发信方将明文
（原始数据）和加密密钥（mi yue）一起经过特殊加密算法处理后，使其变成复杂的加密密
文发送出去。收信方收到密文后，若想解读原文，则需要使用加密用过的密钥及相同算法的
逆算法对密文进行解密，才能使其恢复成可读明文。在对称加密算法中，使用的密钥只有一
个，发收信双方都使用这个密钥对数据进行加密和解密，这就要求解密方事先必须知道加密
密钥。
</p>
</div>
</div>

<div id="outline-container-org3881dfc" class="outline-3">
<h3 id="org3881dfc">优缺点</h3>
<div class="outline-text-3" id="text-org3881dfc">
<dl class="org-dl">
<dt>优点</dt><dd>算法公开、计算量小、加密速度快、加密效率高。</dd>
<dt>缺点</dt><dd>安全
<ul class="org-ul">
<li>交易双方都使用同样钥匙，安全性得不到保证。</li>
<li>每对用户每次使用对称加密算法时，都需要使用其他人不知道的惟一钥匙，这会使得发
收信双方所拥有的钥匙数量呈几何级数增长，密钥管理成为用户的负担。对称加密算法
在分布式网络系统上使用较为困难，主要是因为密钥管理困难，使用成本较高。</li>
</ul></dd>
</dl>
</div>
</div>

<div id="outline-container-org0b37acd" class="outline-3">
<h3 id="org0b37acd">常用对称加密算法</h3>
<div class="outline-text-3" id="text-org0b37acd">
<p>
基于“对称密钥”的加密算法主要有DES、3DES（TripleDES）、AES、RC2、RC4、RC5和
Blowfish等。本文只介绍最常用的对称加密算法DES、3DES（TripleDES）和AES。
</p>
</div>
</div>
</div>

<div id="outline-container-org577ba6a" class="outline-2">
<h2 id="org577ba6a">DES</h2>
<div class="outline-text-2" id="text-org577ba6a">
</div>
<div id="outline-container-org8bfb555" class="outline-3">
<h3 id="org8bfb555"> 概述</h3>
<div class="outline-text-3" id="text-org8bfb555">
<p>
DES算法全称为Data Encryption Standard，即数据加密算法，它是IBM公司于
1975年研究成功并公开发表的。DES算法的入口参数有三个：Key、Data、Mode。
其中Key为8个字节共64位，是DES算法的工作密钥；Data也为8个字节64位，是要
被加密或被解密的数据；Mode为DES的工作方式,有两种：加密或解密。
</p>
</div>
</div>

<div id="outline-container-orgb0066f0" class="outline-3">
<h3 id="orgb0066f0"> 算法原理</h3>
<div class="outline-text-3" id="text-orgb0066f0">
<p>
DES算法把64位的明文输入块变为64位的密文输出块，它所使用的密钥也是64位，
其算法主要分为两步：
</p>

<dl class="org-dl">
<dt>初始置换</dt><dd>其功能是把输入的64位数据块按位重新组合,并把输出分为L0、
R0两部分，每部分各长32位，其置换规则为将输入的第58位换到第一
位，第50位换到第2位……依此类推,最后一位是原来的第7位。L0、R0
则是换位输出后的两部分，L0是输出的左32位，R0是右32位，例：设
置换前的输入值为D1D2D3……D64，则经过初始置换后的结果
为:L0=D58D50……D8；R0=D57D49……D7。</dd>
<dt>逆置换</dt><dd>经过16次迭代运算后，得到L16、R16,将此作为输入，进行逆置换，
逆置换正好是初始置换的逆运算，由此即得到密文输出。</dd>
</dl>
</div>
</div>

<div id="outline-container-org6016606" class="outline-3">
<h3 id="org6016606"> 五种分组模式</h3>
<div class="outline-text-3" id="text-org6016606">
</div>
<div id="outline-container-orgf2cb3dc" class="outline-4">
<h4 id="orgf2cb3dc">EBC模式</h4>
<div class="outline-text-4" id="text-orgf2cb3dc">
<ol class="org-ol">
<li>优点：
<ul class="org-ul">
<li>简单；</li>
<li>有利于并行计算；</li>
<li>误差不会被传送；</li>
</ul></li>
<li>缺点：
<ul class="org-ul">
<li>不能隐藏明文的模式；</li>
<li>可能对明文进行主动攻击。</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org2666b0e" class="outline-4">
<h4 id="org2666b0e">CBC模式</h4>
<div class="outline-text-4" id="text-org2666b0e">
<p>
 CBC模式又称为密码分组链接模式，示意图如下：
</p>
<ol class="org-ol">
<li>优点：
<ul class="org-ul">
<li>不容易主动攻击,安全性好于ECB,适合传输长度长的报文,是SSL、IPSec的标准。</li>
</ul></li>
<li>缺点：
<ul class="org-ul">
<li>不利于并行计算；</li>
<li>误差传递；</li>
<li>需要初始化向量IV。</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org1e2f1e7" class="outline-4">
<h4 id="org1e2f1e7">CFB模式</h4>
<div class="outline-text-4" id="text-org1e2f1e7">
<p>
 CFB模式又称为密码发反馈模式，示意图如下图所示：
</p>
<ol class="org-ol">
<li>优点：
<ul class="org-ul">
<li>隐藏了明文模式；</li>
<li>分组密码转化为流模式；</li>
<li>可以及时加密传送小于分组的数据。</li>
</ul></li>
<li>缺点:
<ul class="org-ul">
<li>不利于并行计算；</li>
<li>误差传送：一个明文单元损坏影响多个单元；</li>
<li>唯一的IV。</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-org3ee964f" class="outline-4">
<h4 id="org3ee964f">OFB模式</h4>
<div class="outline-text-4" id="text-org3ee964f">
<p>
OFB模式又称输出反馈模式，示意图所下图所示：
</p>
<ol class="org-ol">
<li>优点：
<ul class="org-ul">
<li>隐藏了明文模式；</li>
<li>分组密码转化为流模式；</li>
<li>可以及时加密传送小于分组的数据。</li>
</ul></li>
<li>缺点：
<ul class="org-ul">
<li>不利于并行计算；</li>
<li>对明文的主动攻击是可能的；</li>
<li>误差传送：一个明文单元损坏影响多个单元。</li>
</ul></li>
</ol>
</div>
</div>

<div id="outline-container-orgdd9ac56" class="outline-4">
<h4 id="orgdd9ac56">CTR模式</h4>
<div class="outline-text-4" id="text-orgdd9ac56">
<p>
计数模式（CTR模式）加密是对一系列输入数据块(称为计数)进行加密，产生一
系列的输出块，输出块与明文异或得到密文。对于最后的数据块，可能是长u位
的局部数据块，这u位就将用于异或操作，而剩下的b-u位将被丢弃（b表示块的
长度）。CTR解密类似。这一系列的计数必须互不相同的。假定计数表示为T1,
T2, …, Tn。CTR模式可定义如下：
</p>

<p>
CTR加密公式如下：
</p>
<pre class="example">
Cj = Pj XOR Ek(Tj)
C*n = P*n XOR MSBu(Ek(Tn)) j = 1，2… n-1;
CTR解密公式如下：
Pj = Cj XOR Ek(Tj)
P*n = C*n XOR MSBu(Ek(Tn)) j = 1，2 … n-1;
</pre>

<p>
AES CTR模式的结构如图5所示。
</p>

<p>
图5 AES CTR的模式结构
Fig 5 Structure of AES CTR Mode
</p>

<p>
加密方式：密码算法产生一个16 字节的伪随机码块流，伪随机码块与输入的明
文进行异或运算后产生密文输出。密文与同样的伪随机码进行异或运算后可以重
产生明文。
</p>

<p>
CTR 模式被广泛用于 ATM 网络安全和 IPSec应用中，相对于其它模式而言，CRT
模式具有如下特点：
</p>
<ul class="org-ul">
<li>硬件效率：允许同时处理多块明文 / 密文。</li>
<li>软件效率：允许并行计算，可以很好地利用 CPU 流水等并行技术。</li>
<li>预处理：算法和加密盒的输出不依靠明文和密文的输入，因此如果有足够的保
证安全的存储器，加密算法将仅仅是一系列异或运算，这将极大地提高吞吐量。</li>
<li>随机访问：第 i 块密文的解密不依赖于第 i-1 块密文，提供很高的随机访问
能力</li>
<li>可证明的安全性：能够证明 CTR 至少和其他模式一样安全
（CBC, CFB, OFB, &#x2026;）</li>
<li>简单性：与其它模式不同，CTR模式仅要求实现加密算法，但不要求实现解密
算法。对于 AES 等加/解密本质上不同的算法来说，这种简化是巨大的。</li>
<li>无填充，可以高效地作为流式加密使用。</li>
</ul>
</div>
</div>
</div>

<div id="outline-container-org83801f8" class="outline-3">
<h3 id="org83801f8">常用的填充方式</h3>
<div class="outline-text-3" id="text-org83801f8">
<p>
在Java进行DES、3DES和AES三种对称加密算法时，常采用的是NoPadding（不填充）、Zeros
填充（0填充）、PKCS5Padding填充。
</p>
</div>

<div id="outline-container-org3ec534f" class="outline-4">
<h4 id="org3ec534f">ZerosPadding</h4>
<div class="outline-text-4" id="text-org3ec534f">
<p class="verse">
全部填充为0的字节，结果如下：<br>
F1 F2 F3 F4 F5 F6 F7 F8   //第一块<br>
F9 00 00 00 00 00 00 00 //第二块<br>
</p>
</div>
</div>

<div id="outline-container-org0a84d18" class="outline-4">
<h4 id="org0a84d18">PKCS5Padding</h4>
<div class="outline-text-4" id="text-org0a84d18">
<pre class="example">
每个填充的字节都记录了填充的总字节数，结果如下：
F1 F2 F3 F4 F5 F6 F7 F8   //第一块
F9 07 07 07 07 07 07 07 //第二块
</pre>
</div>
</div>
</div>
</div>

        </div>    </div>
    <div id="postamble" class="status"><div id="archive" style="padding-top: 3em; padding-bottom: 2em;"><a href="/archive.html">其它文章</a></div><script src="/js/av-min-1.5.0.js"></script>    </div>
</body>
</html>
